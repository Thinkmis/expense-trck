<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Expense Tracker</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #fdf6e3;
        color: #5d4037;
        margin:0;
        padding:0;
    }
    .container {
        width: 400px;
        max-width: 90%;
        margin: 50px auto;
        padding: 20px;
        background: #fff8f0;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
        text-align:center;
        margin-bottom:20px;
    }
    .form-group {
        margin-bottom:15px;
    }
    label {
        display:block;
        margin-bottom:5px;
    }
    input {
        width:100%;
        padding:8px;
        box-sizing:border-box;
        border:1px solid #d7ccc8;
        border-radius:5px;
    }
    button {
        width:100%;
        padding:10px;
        background:#a1887f;
        color:#fff;
        border:none;
        border-radius:5px;
        cursor:pointer;
        font-size:16px;
    }
    button:hover {
        background:#8d6e63;
    }
    .form-message {
        margin-bottom:10px;
        text-align:center;
    }
    a {
        color:#5d4037;
    }
    #dashboard {
        width: 90%;
        max-width: 1000px;
        margin: 20px auto;
    }
    .section {
        background: #fff8f0;
        padding:20px;
        margin-bottom:20px;
        border-radius:10px;
    }
    .flex {
        display:flex;
        gap:10px;
        flex-wrap:wrap;
    }
    .flex button {
        flex:1;
    }
</style>
</head>
<body>

<div id="loginSection" class="container">
    <h2>Login</h2>
    <div class="form-message" id="loginMessage"></div>
    <div class="form-group">
        <label>Email:</label>
        <input type="email" id="loginEmail">
    </div>
    <div class="form-group">
        <label>Password:</label>
        <input type="password" id="loginPassword">
    </div>
    <button id="loginBtn">Login</button>
    <p>Don't have an account? <a href="#" id="goSignup">Sign up here</a></p>
</div>

<div id="signupSection" class="container" style="display:none;">
    <h2>Sign Up</h2>
    <div class="form-message" id="signupMessage"></div>
    <div class="form-group">
        <label>Name:</label>
        <input type="text" id="name">
    </div>
    <div class="form-group">
        <label>Email:</label>
        <input type="email" id="email">
    </div>
    <div class="form-group">
        <label>Password:</label>
        <input type="password" id="password">
    </div>
    <div class="form-group">
        <label>Age:</label>
        <input type="number" id="age">
    </div>
    <div class="form-group">
        <label>Profession:</label>
        <input type="text" id="profession">
    </div>
    <div class="form-group">
        <label>City:</label>
        <input type="text" id="city">
    </div>
    <div class="form-group">
        <label>Phone:</label>
        <input type="tel" id="phone">
    </div>
    <button id="signupBtn">Sign Up</button>
    <p>Already have an account? <a href="#" id="goLogin">Login here</a></p>
</div>

<div id="dashboard" style="display:none;">
    <h2>Dashboard</h2>
    <div class="section" id="profileInfo">
        <h3>Profile Info</h3>
        <p><strong>Name:</strong> <span id="dName"></span></p>
        <p><strong>Email:</strong> <span id="dEmail"></span></p>
        <p><strong>Age:</strong> <span id="dAge"></span></p>
        <p><strong>Profession:</strong> <span id="dProfession"></span></p>
        <p><strong>City:</strong> <span id="dCity"></span></p>
        <p><strong>Phone:</strong> <span id="dPhone"></span></p>
    </div>

    <div class="section" id="addExpense">
        <h3>Add Expense</h3>
        <div class="form-group">
            <label>Description:</label>
            <input type="text" id="expenseDesc">
        </div>
        <div class="form-group">
            <label>Amount:</label>
            <input type="number" id="expenseAmount">
        </div>
        <button id="addExpenseBtn">Add Expense</button>
    </div>

    <div class="section" id="graphSection">
        <h3>Expenses Graph</h3>
        <div class="flex">
            <button data-period="weekly" class="graphBtn">Weekly</button>
            <button data-period="monthly" class="graphBtn">Monthly</button>
            <button data-period="yearly" class="graphBtn">Yearly</button>
        </div>
        <canvas id="expenseChart" height="150"></canvas>
    </div>

    <div class="section" id="challenges">
        <h3>Challenges</h3>
        <ul>
            <li>Save 20% of your income this month</li>
            <li>Limit daily spending to $50</li>
            <li>Track all expenses for a week</li>
        </ul>
    </div>

    <div class="section">
        <button id="logoutBtn">Logout</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const loginSection = document.getElementById('loginSection');
const signupSection = document.getElementById('signupSection');
const dashboard = document.getElementById('dashboard');

// Switch sections
document.getElementById('goSignup').onclick = () => {
    loginSection.style.display='none';
    signupSection.style.display='block';
};
document.getElementById('goLogin').onclick = () => {
    signupSection.style.display='none';
    loginSection.style.display='block';
};

// Sign Up
document.getElementById('signupBtn').onclick = () => {
    const user = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        password: document.getElementById('password').value,
        age: document.getElementById('age').value,
        profession: document.getElementById('profession').value,
        city: document.getElementById('city').value,
        phone: document.getElementById('phone').value,
        expenses: []
    };
    let users = JSON.parse(localStorage.getItem('users')) || [];
    const msg = document.getElementById('signupMessage');
    if(users.some(u=>u.email===user.email)){
        msg.textContent = "Email already exists!";
        msg.style.color="red";
        return;
    }
    users.push(user);
    localStorage.setItem('users', JSON.stringify(users));
    localStorage.setItem('currentUser', JSON.stringify(user));
    loadDashboard();
};

// Login
document.getElementById('loginBtn').onclick = () => {
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    let users = JSON.parse(localStorage.getItem('users')) || [];
    const user = users.find(u=>u.email===email && u.password===password);
    const msg = document.getElementById('loginMessage');
    if(user){
        localStorage.setItem('currentUser', JSON.stringify(user));
        loadDashboard();
    } else {
        msg.textContent = "Invalid email or password!";
        msg.style.color="red";
    }
};

// Logout
document.getElementById('logoutBtn').onclick = () => {
    localStorage.removeItem('currentUser');
    dashboard.style.display='none';
    loginSection.style.display='block';
};

// Dashboard
function loadDashboard(){
    loginSection.style.display='none';
    signupSection.style.display='none';
    dashboard.style.display='block';
    const user = JSON.parse(localStorage.getItem('currentUser'));
    document.getElementById('dName').textContent = user.name;
    document.getElementById('dEmail').textContent = user.email;
    document.getElementById('dAge').textContent = user.age;
    document.getElementById('dProfession').textContent = user.profession;
    document.getElementById('dCity').textContent = user.city;
    document.getElementById('dPhone').textContent = user.phone;
    updateChart('weekly');
}

// Add Expense
document.getElementById('addExpenseBtn').onclick = () => {
    const desc = document.getElementById('expenseDesc').value;
    const amt = parseFloat(document.getElementById('expenseAmount').value);
    if(!desc || !amt) return;
    let user = JSON.parse(localStorage.getItem('currentUser'));
    user.expenses.push({desc, amt, date: new Date().toISOString()});
    localStorage.setItem('currentUser', JSON.stringify(user));

    // Update in users array
    let users = JSON.parse(localStorage.getItem('users'));
    const index = users.findIndex(u=>u.email===user.email);
    users[index] = user;
    localStorage.setItem('users', JSON.stringify(users));

    document.getElementById('expenseDesc').value='';
    document.getElementById('expenseAmount').value='';
    updateChart(document.querySelector('.graphBtn.active')?.dataset.period || 'weekly');
};

// Graph.js
let chart;
const ctx = document.getElementById('expenseChart').getContext('2d');

function updateChart(period){
    document.querySelectorAll('.graphBtn').forEach(btn=>btn.classList.remove('active'));
    document.querySelector(`.graphBtn[data-period="${period}"]`).classList.add('active');
    const user = JSON.parse(localStorage.getItem('currentUser'));
    let labels=[], data=[];
    const now = new Date();
    if(period==='weekly'){
        labels = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
        data = labels.map((d,i)=>{
            const day = new Date();
            day.setDate(now.getDate()-now.getDay()+i);
            return user.expenses.filter(e=>new Date(e.date).toDateString()===day.toDateString()).reduce((sum,e)=>sum+e.amt,0);
        });
    } else if(period==='monthly'){
        labels = Array.from({length:30},(_,i)=>i+1);
        data = labels.map(d=>{
            return user.expenses.filter(e=>new Date(e.date).getDate()===d).reduce((sum,e)=>sum+e.amt,0);
        });
    } else if(period==='yearly'){
        labels = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        data = labels.map((m,i)=>{
            return user.expenses.filter(e=>new Date(e.date).getMonth()===i).reduce((sum,e)=>sum+e.amt,0);
        });
    }

    if(chart) chart.destroy();
    chart = new Chart(ctx,{
        type:'bar',
        data:{
            labels,
            datasets:[{
                label:'Expenses ($)',
                data,
                backgroundColor:'#a1887f'
            }]
        },
        options:{responsive:true, plugins:{legend:{display:false}}}
    });
}

// Graph buttons
document.querySelectorAll('.graphBtn').forEach(btn=>{
    btn.onclick = ()=>updateChart(btn.dataset.period);
});

// Auto load dashboard if user is logged in
if(localStorage.getItem('currentUser')) loadDashboard();
</script>

</body>
</html>

